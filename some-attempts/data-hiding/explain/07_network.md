# 07 — 网络隐蔽信道（Covert Channel via HTTP Headers/Fields）

对应样本：`attack/07_http_headers_SIMULATED.http`

## 这类“攻击”在做什么
攻击者把额外信息塞进网络请求的“非核心字段”里（例如自定义 header、某些可选参数），让它随正常业务流量传输。

> 本样本只是一个静态的、可疑风格的 HTTP 报文示例，不是可执行外传工具。

## 典型风险场景
- **绕过内容审计**：业务只关注 body，而忽略 header。
- **隐蔽协调**：在分布式系统调用中夹带“暗号”或跟踪信息。

## 可观测信号
- 出现异常的 `X-*` header，或 header 值明显不符合业务语义。
- header 值高熵、长度异常、变化频率异常。
- 同一客户端在短时间内发出大量携带自定义 header 的请求。

## 防护与缓解
- **字段白名单**：网关只允许必要 header 通过，其余剥离或拒绝。
- **阈值检测**：限制 header 总长度、单 header 最大长度、可疑 header 名称集合。
- **日志与审计**：对 `X-*` 等字段做可控的日志采集（注意脱敏）。

## 练习建议
- 写规则：识别 `X-Extra` / `X-Debug-Trace` 这类字段并输出原因。
- 设计处置：对疑似通道做阻断、告警、关联用户与请求链路。
