# 06 — 容器/归档结构滥用（Archive/Container Structure Abuse）

对应样本：`attack/06_archive_structure_SIMULATED.txt`

## 这类“攻击”在做什么
容器格式（zip/tar/7z 等）可以携带大量文件与结构信息。攻击者可能利用：
- 过深目录层级
- 重复条目、名称碰撞
- 隐藏目录（如平台特有目录）
- 额外字段/注释区
来伪装数据或绕过解压扫描。

> 本仓库不提供真实 crafted archive，只提供“可疑列表”描述用于训练。

## 典型风险场景
- **绕过网关扫描**：扫描器只看顶层文件名或只解压一层。
- **误导人工检查**：看起来像正常素材包，但内部结构异常。

## 可观测信号
- 解压后目录深度异常、条目数异常。
- 出现重复文件名或同名不同内容。
- 压缩包内包含系统/隐藏目录（例如 `__MACOSX`）。

## 防护与缓解
- **解包策略**：强制完整解压并递归扫描（同时设置资源上限）。
- **限制与校验**：限制最大条目数、最大目录深度、阻止重复条目。
- **内容策略**：对外来压缩包执行“重新打包/标准化”流程。

## 练习建议
- 基于描述样本写规则：检测“重复条目”“深目录”等特征。
- 设计处置：阻断/隔离/上报 + 记录审计证据。
